var U=(e,s,t)=>new Promise((l,r)=>{var n=p=>{try{u(t.next(p))}catch(w){r(w)}},a=p=>{try{u(t.throw(p))}catch(w){r(w)}},u=p=>p.done?l(p.value):Promise.resolve(p.value).then(n,a);u((t=t.apply(e,s)).next())});import{m as C,o as i,f as d,n as c,t as y,u as h,g as f,h as F,p as $,q as Y,e as L,c as T,w as O,v as H,x as W,y as Z,P as ee,_ as D,J as se,Q as te,X as oe,Y as le,G as re,z as ne,i as k,A as V,B as I,F as E,H as N,K as j,L as G,M as J,N as b,O as M,R as z,S as Q,r as ie,T as ae,a as ce,U as ue,V as de,W as me,Z as _e,$ as he}from"./vendor.52e9d3a7.js";import{_ as K}from"./index.bc062a8d.js";const fe={class:"bg-gray-300 w-screen h-full flex items-center justify-between p-4"},pe=c("div",{class:"flex gap-4"},[c("div",null," han "),c("div",null," Ant-Pos ")],-1),ve={class:"flex gap-4"},be={setup(e){const s=C("base");return(t,l)=>{var r,n;return i(),d("div",fe,[pe,c("div",ve,[c("div",null,y((n=(r=h(s))==null?void 0:r.Ant_Opening_Shift)==null?void 0:n.pos_profile),1),f(h(Y),{options:[{label:"Close Shift",onClick:()=>{},icon:()=>F(h($),{name:"file-minus"})},{label:"Logout",onClick:()=>{},icon:()=>F(h($),{name:"log-out"})}],button:{label:"Menu"}},null,8,["options"])])])}}},ye={class:"w-1/2"},ge={key:0,class:"text-center text-gray-500"},xe={key:1},we={class:"flex justify-between items-center border-b pb-4"},Ce={class:"flex justify-between w-full"},Oe={class:"text-lg font-medium mr-4"},ke=c("span",{class:"text-sm text-gray-500"},"Qty: 1",-1),Se={class:"text-sm text-gray-500"},Ve={class:"text-lg font-semibold ml-4"},Ie={setup(e){const s=L(""),t=L([]);let l=C("base");const r=T({url:"ant_pos.ant_pos.api.item.scan_barcode",method:"GET",debounce:300,makeParams(){return{search_value:s.value}},validate(o){if(!o.search_value)return"Search value is required";if(!l.customer)return"Please select a customer"},onSuccess(o){o.serial_no&&(o.selected_serial_no=[o.serial_no]),console.log(o,"Search result data"),p(o)||n.fetch({search_value:JSON.stringify(o)})},onError(o){console.error("Search error:",o)}}),n=T({url:"ant_pos.ant_pos.api.item.items",method:"GET",debounce:500,initialData:[],auto:!1,makeParams(o){return{pos_profile:JSON.stringify(l.pos_profile),search_value:o.search_value,customer:l.customer.name}},validate(o){if(!o.search_value)return"Search value is required"},onError(o){console.error("Add items error:",o)},onSuccess(o){console.log(o,"Add items data"),u(o)}}),a=T({url:"erpnext.stock.get_item_details.apply_price_list",method:"POST",debounce:500,auto:!1,makeParams(){return{args:JSON.stringify({items:[{doctype:"Sales Invoice Item",name:"new-sales-invoice-item-lrdmbgmbcz",child_docname:"new-sales-invoice-item-lrdmbgmbcz",item_code:"SR-MWR-SRT-LINEN-HS",item_group:"SURPLUS PRODUCTS",brand:null,qty:2,stock_qty:2,uom:"Nos",stock_uom:"Nos",parenttype:"Sales Invoice",parent:"new-sales-invoice-owspmikswv",pricing_rules:["PRLE-0003"],is_free_item:0,warehouse:"MG Road - FITPL",serial_no:`3030012506
3030012508`,batch_no:"B303001-24010-00010",price_list_rate:1899,conversion_factor:1,margin_type:"Percentage",margin_rate_or_amount:0}],customer:l.customer.name,customer_group:l.customer.customer_group,territory:"India",currency:l.pos_profile.currency,conversion_rate:1,price_list:"Standard Selling",price_list_currency:"INR",plc_conversion_rate:1,company:l.pos_profile.company,transaction_date:"",ignore_pricing_rule:0,doctype:"Sales Invoice",name:"new-sales-invoice-owspmikswv",is_return:0,update_stock:1,pos_profile:"FORMOST MG Road",is_internal_customer:0})}},onError(o){console.error("Price list error:",o)},onSuccess(o){console.log("Price list data:",o)}}),u=o=>{o.doctype="Sales Invoice Item",o.parenttype="Sales Invoice",p(o)||(o.has_batch_no&&o.batch_no&&(o.serial_no_options=o.serial_no.filter(m=>o.batch_no&&m.batch_no===o.batch_no).map(m=>({label:m.serial_no,value:m.serial_no}))),w(o))},p=o=>{let m=!1;return l.pos_profile.custom_allow_add_new_items_on_new_line||l.items.forEach((v,g)=>{if(o.item_code===v.item_code&&(o.has_batch_no&&o.batch_no===(v.batch_no.value||v.batch_no)||!o.has_batch_no)){if(o.has_serial_no&&o.serial_no)for(let S of o.selected_serial_no){if(v.selected_serial_no.includes(S))return!0;R(l.items[g].selected_serial_no,o.selected_serial_no[0])}l.items[g].qty+=1,m=!0,l.item,console.log("ooooooooooooooooooooooooooooooooo"),a.fetch({items:l.items[g]})}}),m},w=o=>{l.items.push(o)},R=(o,m)=>{o.push(m)};return(o,m)=>(i(),d("div",ye,[c("div",null,[c("div",null,[f(h(W),{type:"text",modelValue:s.value,"onUpdate:modelValue":m[0]||(m[0]=v=>s.value=v),placeholder:"Search Items",size:"sm",variant:"subtle",onKeyup:m[1]||(m[1]=H(v=>h(r).fetch(),["enter"]))},{prefix:O(()=>[f(h($),{class:"w-4",name:"search"})]),_:1},8,["modelValue"]),c("div",null,[t.value.length===0?(i(),d("div",ge," No items found. Try searching again. ")):(i(),d("div",xe,[c("div",we,[c("div",Ce,[c("span",Oe,y(t.value.item_code),1),ke,c("span",Se,"Price: "+y(t.value.rate),1),c("span",Ve,y(t.value.serial_no),1)])])]))])])])]))}},Pe={name:"Autocomplete",props:["modelValue","options","placeholder","bodyClasses","multiple","hideSearch"],emits:["update:modelValue","update:query","change"],components:{Popover:ee,Button:D,FeatherIcon:$,Combobox:se,ComboboxInput:te,ComboboxOptions:oe,ComboboxOption:le,ComboboxButton:re},expose:["togglePopover","closeOptions"],data(){return{query:"",showOptions:!1}},computed:{selectedValue:{get(){var e,s;return this.multiple?P((e=this.modelValue)==null?void 0:e[0])==="value"?(s=this.modelValue)==null?void 0:s.map(t=>this.findOption(t)):this.modelValue:this.findOption(this.modelValue)},set(e){this.query="",e&&!this.multiple&&(this.showOptions=!1),this.$emit("update:modelValue",e)}},groups(){var s;return!this.options||this.options.length===0?[]:(((s=this.options[0])==null?void 0:s.group)?this.options:[{group:"",items:this.sanitizeOptions(this.options)}]).map((t,l)=>{const r=this.sanitizeOptions(t.items)||[];return{key:l,group:t.group,hideLabel:t.hideLabel||!1,items:this.filterOptions(r)}}).filter(t=>t.items.length>0)},allOptions(){return this.groups.flatMap(e=>e.items)},areAllOptionsSelected(){var e;return this.multiple?this.allOptions.length===((e=this.selectedValue)==null?void 0:e.length):!1}},watch:{query(e){this.$emit("update:query",e)},showOptions(e){e&&ne(()=>{var s,t;return(t=(s=this.$refs.searchInput)==null?void 0:s.$el)==null?void 0:t.focus()})}},methods:{togglePopover(e){this.showOptions=e!=null?e:!this.showOptions},closeOptions(){console.log("Closing options..."),this.showOptions=!1,this.openPopover=!1,this.togglePopover=!1,this.isComboboxOpen=!1},findOption(e){if(!e)return e;const s=P(e)==="value"?e:e.value;return this.allOptions.find(t=>t.value===s)},filterOptions(e){if(!e)return[];if(!this.query)return e;const s=this.query.trim().toLowerCase();return e.filter(t=>{var a,u;const l=(a=t.label)==null?void 0:a.toLowerCase().includes(s),r=(u=t.value)==null?void 0:u.toLowerCase().includes(s),n=t.mobile_no?t.mobile_no.toString().toLowerCase().includes(s):!1;return l||r||n})},displayValue(e){return e?this.multiple?Array.isArray(e)?e.map(s=>this.getLabel(this.findOption(s))).join(", "):"":this.getLabel(this.findOption(e)):""},getLabel(e){return P(e)==="value"?e:(e==null?void 0:e.label)||(e==null?void 0:e.value)||"No Name"},getmobile(e){return P(e)==="value"?e:(e==null?void 0:e.mobile_no)||""},sanitizeOptions(e){return e?e.map(s=>P(s)==="option"?s:{label:s,value:s}):[]},isOptionSelected(e){var t,l;if(!this.selectedValue)return!1;const s=P(e)==="value"?e:e.value;return this.multiple?(l=this.selectedValue)==null?void 0:l.find(r=>r&&r.value===s):((t=this.selectedValue)==null?void 0:t.value)===s},selectAll(){this.selectedValue=this.allOptions},clearAll(){this.selectedValue=[]}}};function P(e){return typeof e=="object"?"option":"value"}const $e={class:"w-full"},Le=["onClick"],Ae={class:"flex items-center overflow-hidden"},Re={key:0,class:"truncate text-base leading-5"},Ee={key:1,class:"text-base leading-5 text-gray-500"},Ne={key:0,class:"sticky top-0 z-10 flex items-stretch space-x-1.5 bg-white py-1.5"},je={class:"relative w-full"},qe={key:0,class:"sticky top-10 truncate bg-white px-2.5 py-1.5 text-sm font-medium text-gray-600"},Te={class:"flex flex-1 gap-2 overflow-hidden"},Me={key:0,class:"flex-shrink-0"},ze={key:1,class:"h-4 w-4"},Be={class:"flex-1 truncate"},Ue={class:"truncate"},Fe={key:0,class:"ml-2 flex-shrink-0"},De={key:0,class:"text-sm text-gray-600"},Ge={key:1,class:"rounded-md px-2.5 py-1.5 text-base text-gray-600"},Je={key:0,class:"border-t p-1"},Qe={key:0,class:"flex items-center justify-end"};function Ke(e,s,t,l,r,n){const a=k("ComboboxInput"),u=k("FeatherIcon"),p=k("ComboboxOption"),w=k("ComboboxOptions"),R=k("Button"),o=k("Popover"),m=k("Combobox");return i(),V(m,{modelValue:n.selectedValue,"onUpdate:modelValue":s[3]||(s[3]=v=>n.selectedValue=v),multiple:t.multiple,nullable:""},{default:O(({open:v})=>[f(o,{class:"w-full",show:r.showOptions,"onUpdate:show":s[2]||(s[2]=g=>r.showOptions=g)},{target:O(({open:g,togglePopover:S})=>[I(e.$slots,"target",N(j({open:g,togglePopover:S})),()=>[c("div",$e,[c("button",{class:E(["flex h-7 w-full items-center justify-between gap-2 rounded bg-gray-100 px-2 py-1 transition-colors hover:bg-gray-200 focus:ring-2 focus:ring-gray-400",{"bg-gray-200":v}]),onClick:()=>S()},[c("div",Ae,[I(e.$slots,"prefix"),n.selectedValue?(i(),d("span",Re,y(n.displayValue(n.selectedValue)),1)):(i(),d("span",Ee,y(t.placeholder||""),1))]),I(e.$slots,"suffix")],10,Le)])])]),body:O(({isOpen:g,togglePopover:S})=>[G(c("div",null,[c("div",{class:E(["relative mt-1 rounded-lg bg-white text-base shadow-2xl",t.bodyClasses])},[f(w,{class:E(["max-h-[15rem] overflow-y-auto px-1.5 pb-1.5",{"pt-1.5":t.hideSearch}]),static:""},{default:O(()=>[t.hideSearch?b("",!0):(i(),d("div",Ne,[c("div",je,[f(a,{ref:"searchInput",class:"form-input w-full",type:"text",onChange:s[0]||(s[0]=x=>{r.query=x.target.value}),value:r.query,autocomplete:"off",placeholder:"Search"},null,8,["value"]),c("button",{class:"absolute right-0 inline-flex h-7 w-7 items-center justify-center",onClick:s[1]||(s[1]=x=>n.selectedValue=null)},[f(u,{name:"x",class:"w-4"})])])])),(i(!0),d(z,null,M(n.groups,x=>G((i(),d("div",{key:x.key},[x.group&&!x.hideLabel?(i(),d("div",qe,y(x.group),1)):b("",!0),(i(!0),d(z,null,M(x.items.slice(0,50),(_,X)=>(i(),V(p,{as:"template",key:(_==null?void 0:_.value)||X,value:_},{default:O(({active:q,selected:B})=>[c("li",{class:E(["flex cursor-pointer items-center justify-between rounded px-2.5 py-1.5 text-base",{"bg-gray-100":q}])},[c("div",Te,[e.$slots["item-prefix"]||e.$props.multiple?(i(),d("div",Me,[I(e.$slots,"item-prefix",N(j({active:q,selected:B,option:_})),()=>[n.isOptionSelected(_)?(i(),V(u,{key:0,name:"check",class:"h-4 w-4 text-gray-700"})):(i(),d("div",ze))])])):b("",!0),c("span",Be,y(n.getLabel(_)),1),c("span",Ue,y(n.getmobile(_)),1)]),e.$slots["item-suffix"]||(_==null?void 0:_.description)?(i(),d("div",Fe,[I(e.$slots,"item-suffix",N(j({active:q,selected:B,option:_})),()=>[(_==null?void 0:_.description)?(i(),d("div",De,y(_.description),1)):b("",!0)])])):b("",!0)],2)]),_:2},1032,["value"]))),128))])),[[J,x.items.length>0]])),128)),n.groups.length==0?(i(),d("li",Ge," No results found ")):b("",!0)]),_:3},8,["class"]),e.$slots.footer||t.multiple?(i(),d("div",Je,[I(e.$slots,"footer",N(j({togglePopover:S})),()=>[t.multiple?(i(),d("div",Qe,[n.areAllOptionsSelected?b("",!0):(i(),V(R,{key:0,label:"Select All",onClick:Q(n.selectAll,["stop"])},null,8,["onClick"])),n.areAllOptionsSelected?(i(),V(R,{key:1,label:"Clear All",onClick:Q(n.clearAll,["stop"])},null,8,["onClick"])):b("",!0)])):b("",!0)])])):b("",!0)],2)],512),[[J,g]])]),_:2},1032,["show"])]),_:3},8,["modelValue","multiple"])}var Xe=Z(Pe,[["render",Ke]]);const A=ie({});A.emit=function(e,...s){!this[e]||this[e].forEach(t=>t(...s))};A.on=function(e,s){this[e]||(this[e]=[]),this[e].push(s)};A.off=function(e,s){!this[e]||(this[e]=this[e].filter(t=>t!==s))};A.add_item=function(e,s){!this[e]||(this[e]=this[e].filter(t=>t!==s))};const Ye={class:"w-11/12"},He={setup(e){const s=L(""),t=L(null);C("dynamicComponent");let l=C("base");const r=ae({doctype:"Customer",fields:["name","mobile_no"],filters:{disabled:!1},pageLength:Number.MAX_VALUE*2,auto:!0,transform:a=>a.map(u=>({label:u.name,value:u.name,mobile_no:u.mobile_no}))}),n=ce(()=>(r==null?void 0:r.data)?r.data.map(a=>({mobile_no:a.mobile_no||"",label:a.label||"Unnamed",value:a.value})):[]);return ue(s,(a,u)=>{(a==null?void 0:a.value)&&a.value!==(u==null?void 0:u.value)&&a.value!==""&&(l.customer=a.value)}),de(()=>{A.on("customer-created",a=>{r.fetch().then(()=>{s.value={label:a.name,value:a.name}}).catch(u=>{console.error("Error fetching customer data:",u)})})}),(a,u)=>(i(),d("div",Ye,[f(Xe,{ref_key:"autocompleteRef",ref:t,options:h(n),modelValue:s.value,"onUpdate:modelValue":[u[0]||(u[0]=p=>s.value=p),a.handleCustomer],placeholder:"Select person"},null,8,["options","modelValue","onUpdate:modelValue"])]))}},We={class:"w-1/2 h-full select-none"},Ze={class:"flex gap-4 h-[4%]"},es={class:"py-2 pr-3 h-[76%] overflow-y-scroll"},ss=me('<div class="mb-2"><div class="flex bg-gray-200 w-full py-2 px-3 justify-between rounded text-center"><div class="w-[18.4%]"> Item Code </div><div class="w-[18.4%]"> QTY </div><div class="w-[18.4%]"> UOM </div><div class="w-[18.4%]"> Rate </div><div class="w-[18.4%]"> Amount </div><div class="w-[8%]"> Remove </div></div></div>',1),ts={setup(e){const{loadComponent:s}=C("dynamicComponent");let t=C("base");return(l,r)=>(i(),d("div",We,[c("div",Ze,[f(He),f(h(D),{class:"w-1/12",onClick:r[1]||(r[1]=n=>{h(s)("CustomerForm")}),variant:"solid",ref_for:!0,theme:"gray",size:"sm",label:"Button",loading:!1,loadingText:null,disabled:!1,link:null},{default:O(()=>[f(h($),{class:"w-4 cursor-pointer",name:"plus",onClick:r[0]||(r[0]=n=>{h(s)("CustomerForm")})})]),_:1})]),c("div",es,[ss,(i(!0),d(z,null,M(h(t).items,(n,a)=>(i(),d("div",{key:a,class:"flex flex-col justify-between mb-2"},[f(n,{item:n,index:a},null,8,["item","index"])]))),128))])]))}};function os(){const e=L(null);return{currentComponent:e,loadComponent:t=>U(this,null,function*(){try{const l={OpenShift:()=>K(()=>import("./Open-Shift.30bbef88.js"),["assets/Open-Shift.30bbef88.js","assets/vendor.52e9d3a7.js","assets/vendor.1875b906.css"]),CustomerForm:()=>K(()=>import("./CustomerForm.e144b1c3.js"),["assets/CustomerForm.e144b1c3.js","assets/vendor.52e9d3a7.js","assets/vendor.1875b906.css"])};if(l[t]){e.value=null,yield new Promise(n=>setTimeout(n,0));const r=yield l[t]();e.value=r.default}else console.error(`Component "${t}" not found.`),e.value=null}catch(l){console.error("Error loading component:",l),e.value=null}})}}const ls={class:"w-screen h-screen"},rs={key:0},ns={class:"w-screen h-[6%]"},is={class:"w-screen h-[94%] flex p-2 gap-4"},ds={setup(e){C("base");const{currentComponent:s,loadComponent:t}=os();return t("OpenShift"),he("dynamicComponent",{currentComponent:s,loadComponent:t}),(l,r)=>(i(),d("div",ls,[h(s)?(i(),d("div",rs,[(i(),V(_e(h(s))))])):b("",!0),c("div",ns,[f(be)]),c("div",is,[f(Ie),f(ts)])]))}};export{ds as default};
